<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>This month in hax: October 2024 | hax</title>
<meta name=keywords content="this-month-in-hax"><meta name=description content="In October, we merged 70 PRs! ðŸŽ‰
Thanks to a huge work from Nadrieril on trait resolution, the goal of handling all valid Rust code with hax frontend is now almost achieved. With these improvements and some bugfixes from W95Psp, we now produce JSON without errors for more than 99% of Rust&rsquo;s top 800 crates!
W95Psp worked on a new data representation for communication between the frontend and the engine. This removes redundancy and gives great performance gains."><meta name=author content="Maxime Buyse"><link rel=canonical href=https://hacspec.github.io/blog/posts/this-month-in-hax/2024-10/><link crossorigin=anonymous href=/blog/assets/css/stylesheet.1b82bbed8b13f853704558d527b681efaea938ce91e6ae8903e8b19e73b1b0f8.css integrity="sha256-G4K77YsT+FNwRVjVJ7aB766pOM6R5q6JA+ixnnOxsPg=" rel="preload stylesheet" as=style><link rel=icon href=https://hacspec.github.io/blog/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://hacspec.github.io/blog/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://hacspec.github.io/blog/favicon-32x32.png><link rel=apple-touch-icon href=https://hacspec.github.io/blog/apple-touch-icon.png><link rel=mask-icon href=https://hacspec.github.io/blog/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="This month in hax: October 2024"><meta property="og:description" content="In October, we merged 70 PRs! ðŸŽ‰
Thanks to a huge work from Nadrieril on trait resolution, the goal of handling all valid Rust code with hax frontend is now almost achieved. With these improvements and some bugfixes from W95Psp, we now produce JSON without errors for more than 99% of Rust&rsquo;s top 800 crates!
W95Psp worked on a new data representation for communication between the frontend and the engine. This removes redundancy and gives great performance gains."><meta property="og:type" content="article"><meta property="og:url" content="https://hacspec.github.io/blog/posts/this-month-in-hax/2024-10/"><meta property="og:image" content="https://hacspec.github.io/blog/papermod-cover.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-11-04T00:00:00+00:00"><meta property="article:modified_time" content="2024-11-04T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://hacspec.github.io/blog/papermod-cover.png"><meta name=twitter:title content="This month in hax: October 2024"><meta name=twitter:description content="In October, we merged 70 PRs! ðŸŽ‰
Thanks to a huge work from Nadrieril on trait resolution, the goal of handling all valid Rust code with hax frontend is now almost achieved. With these improvements and some bugfixes from W95Psp, we now produce JSON without errors for more than 99% of Rust&rsquo;s top 800 crates!
W95Psp worked on a new data representation for communication between the frontend and the engine. This removes redundancy and gives great performance gains."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://hacspec.github.io/blog/posts/"},{"@type":"ListItem","position":2,"name":"This month in hax: October 2024","item":"https://hacspec.github.io/blog/posts/this-month-in-hax/2024-10/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"This month in hax: October 2024","name":"This month in hax: October 2024","description":"In October, we merged 70 PRs! ðŸŽ‰\nThanks to a huge work from Nadrieril on trait resolution, the goal of handling all valid Rust code with hax frontend is now almost achieved. With these improvements and some bugfixes from W95Psp, we now produce JSON without errors for more than 99% of Rust\u0026rsquo;s top 800 crates!\nW95Psp worked on a new data representation for communication between the frontend and the engine. This removes redundancy and gives great performance gains.","keywords":["this-month-in-hax"],"articleBody":"In October, we merged 70 PRs! ðŸŽ‰\nThanks to a huge work from Nadrieril on trait resolution, the goal of handling all valid Rust code with hax frontend is now almost achieved. With these improvements and some bugfixes from W95Psp, we now produce JSON without errors for more than 99% of Rustâ€™s top 800 crates!\nW95Psp worked on a new data representation for communication between the frontend and the engine. This removes redundancy and gives great performance gains.\nA new generic printer has been developed by W95Psp and is now available for backend development. The coq backend is the first to use it thanks to the migration work from cmester0.\nI have worked on eliminating circular dependencies between the modules we generate. And also on allowing control flow (return, break and continue) inside loops.\nLast but not least, the effort to release v0.1.0 is almost finished. This comes with documentation and tooling improvements. For example, jschneider-bensch added a simple PSK based protocol as an example for the ProVerif backend.\nMerged Pull Requests #1087: Fix two query panics #1084: fix(engine/simplify_question_marks): fix type arguments on from #1079: Include defaulted items in FullDefKind::TraitImpl #1077: fix(engine) Keep late_skip attributes in bundles #1074: feat(engine): profile each phase (mem usage, time, number of items) #1071: count_ones and bool-\u003eint #1069: Add ImplExpr information to associated types in an impl block #1067: feat(book): allow F* extraction + TC from within the book #1063: Add module information to FullDef #1062: fix(engine) Remove attributes on bundle aliases and filter out NotImplementedYet. #1061: feat(frontend/consts): float lits: use strings not bits, more support #1057: fix(exporter/constants): support usize casted to raw pointers constants #1056: fix(engine) Avoid wrapping return in a tuple. #1055: Include bodies in FullDef #1054: Intern DefIds #1053: Avoid a panic in FullDef #1052: fix(exporter/thir): fix #1048 #1050: Fix #1042 #1049: fix(engine) Move variant constructors in recursive bundling. #1041: fix: rustc_private #1039: Fix 914 #1037: Machine int constructors and conversions #1036: Upgrade rustc #1035: feat: check licenses #1031: Improve trait resolution #1030: Avoid bundling use items. #1029: feat: deduplicate types in haxmeta and JSON #1027: fix(frontend): this was reverted by mistake #1024: Reorganize frontend/exporter/types #1023: PV backend example: Simple PSK based protocol #1022: some fixes for iterators.f_next and update_at_usize #1020: Quote items track replace #1018: fix(engine/import_thir): never drop bodies of constants #1015: fix(frontend): issue #1014 #1012: fix: justfile #1011: fix(engine): also rename concrete idents within a projector. #1008: Support impl Trait in trait resolution #1007: feat(cli): better version information #1006: Support more features #1002: Fix bug with recursive bundles depending on items from original modules. #1000: Cache FullDef translation and add more information to it #999: Exporter get variant information works on unions #996: Cache many things #994: fix: DEV.md debug engine #990: Remove workaround in trait resolution for associated items #989: fix(engine): make consts fun. calls of arity 0 when there is an impl expr #988: feat(engine) Rewrite control flow inside loops. #987: Coq generic printer #984: feat: just use just #981: Make options extensible #977: More improvements to trait resolution #970: Rework trait resolution to support GATs #969: Release 0.1.0-alpha.1 #964: feat(contributing): add a regressions section #961: Update README.md #960: feat(engine): add ast_destruct module #959: Prefer try_normalize_erasing_regions #958: feat(engine): add module ast_builder #957: Ignore structs in variants renaming for bundling. #956: Run cargo clippy --fix #955: feat(frontend): collect regular comments #952: feat(doc): add CONTRIBUTING.md #950: feat(nix/utils): intro. check-unimlemented-issue-coherency #949: fix(engine): change issue id #948: fix(engine/f*): convert an unimplemented to an assertion failure #947: fix(exporter+engine): drop default parameters on traits #945: feat(engine/f*): allow unsafe code #935: Handle cyclic module dependencies #851: fix(engine): expose type of local_ident.id #533: more principled generic printer Contributors @cmester0 @W95Psp @jschneider-bensch @spitters @franziskuskiefer @Nadrieril @karthikbhargavan @maximebuyse @paulmure ","wordCount":"611","inLanguage":"en","datePublished":"2024-11-04T00:00:00Z","dateModified":"2024-11-04T00:00:00Z","author":{"@type":"Person","name":"Maxime Buyse"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://hacspec.github.io/blog/posts/this-month-in-hax/2024-10/"},"publisher":{"@type":"Organization","name":"hax","logo":{"@type":"ImageObject","url":"https://hacspec.github.io/blog/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://hacspec.github.io/blog/ accesskey=h title="hax (Alt + H)">hax</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://hacspec.github.io/blog/archives title=Archive><span>Archive</span></a></li><li><a href=https://hacspec.github.io/blog/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://hacspec.github.io/blog/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>This month in hax: October 2024</h1><div class=post-meta><span title='2024-11-04 00:00:00 +0000 UTC'>November 4, 2024</span>&nbsp;Â·&nbsp;3 min&nbsp;Â·&nbsp;Maxime Buyse</div></header><div class=post-content><p>In October, we merged 70 PRs! ðŸŽ‰</p><p>Thanks to a huge work from <a href=https://github.com/Nadrieril>Nadrieril</a> on trait resolution, the goal of handling all valid Rust code with hax frontend is now almost achieved. With these improvements and some bugfixes from <a href=https://github.com/W95Psp>W95Psp</a>, we now produce JSON without errors for more than 99% of Rust&rsquo;s top 800 crates!</p><p><a href=https://github.com/W95Psp>W95Psp</a> worked on a new data representation for communication between the frontend and the engine. This removes redundancy and gives great performance gains.</p><p>A new generic printer has been developed by <a href=https://github.com/W95Psp>W95Psp</a> and is now available for backend development. The coq backend is the first to use it thanks to the migration work from <a href=https://github.com/cmester0>cmester0</a>.</p><p>I have worked on eliminating circular dependencies between the modules we generate. And also on allowing control flow (<code>return</code>, <code>break</code> and <code>continue</code>) inside loops.</p><p>Last but not least, the effort to release v0.1.0 is almost finished. This comes with documentation and tooling improvements. For example, <a href=https://github.com/jschneider-bensch>jschneider-bensch</a> added a simple PSK based protocol as an example for the ProVerif backend.</p><h1 id=merged-pull-requests>Merged Pull Requests<a hidden class=anchor aria-hidden=true href=#merged-pull-requests>#</a></h1><ul><li>#1087: <a href=https://github.com/hacspec/hax/pull/1087>Fix two query panics</a></li><li>#1084: <a href=https://github.com/hacspec/hax/pull/1084>fix(engine/simplify_question_marks): fix type arguments on <code>from</code></a></li><li>#1079: <a href=https://github.com/hacspec/hax/pull/1079>Include defaulted items in <code>FullDefKind::TraitImpl</code></a></li><li>#1077: <a href=https://github.com/hacspec/hax/pull/1077>fix(engine) Keep late_skip attributes in bundles</a></li><li>#1074: <a href=https://github.com/hacspec/hax/pull/1074>feat(engine): profile each phase (mem usage, time, number of items)</a></li><li>#1071: <a href=https://github.com/hacspec/hax/pull/1071>count_ones and bool->int</a></li><li>#1069: <a href=https://github.com/hacspec/hax/pull/1069>Add <code>ImplExpr</code> information to associated types in an impl block</a></li><li>#1067: <a href=https://github.com/hacspec/hax/pull/1067>feat(book): allow F* extraction + TC from within the book</a></li><li>#1063: <a href=https://github.com/hacspec/hax/pull/1063>Add module information to <code>FullDef</code></a></li><li>#1062: <a href=https://github.com/hacspec/hax/pull/1062>fix(engine) Remove attributes on bundle aliases and filter out NotImplementedYet.</a></li><li>#1061: <a href=https://github.com/hacspec/hax/pull/1061>feat(frontend/consts): float lits: use strings not bits, more support</a></li><li>#1057: <a href=https://github.com/hacspec/hax/pull/1057>fix(exporter/constants): support usize casted to raw pointers constants</a></li><li>#1056: <a href=https://github.com/hacspec/hax/pull/1056>fix(engine) Avoid wrapping return in a tuple.</a></li><li>#1055: <a href=https://github.com/hacspec/hax/pull/1055>Include bodies in <code>FullDef</code></a></li><li>#1054: <a href=https://github.com/hacspec/hax/pull/1054>Intern <code>DefId</code>s</a></li><li>#1053: <a href=https://github.com/hacspec/hax/pull/1053>Avoid a panic in <code>FullDef</code></a></li><li>#1052: <a href=https://github.com/hacspec/hax/pull/1052>fix(exporter/thir): fix #1048</a></li><li>#1050: <a href=https://github.com/hacspec/hax/pull/1050>Fix #1042</a></li><li>#1049: <a href=https://github.com/hacspec/hax/pull/1049>fix(engine) Move variant constructors in recursive bundling.</a></li><li>#1041: <a href=https://github.com/hacspec/hax/pull/1041>fix: rustc_private</a></li><li>#1039: <a href=https://github.com/hacspec/hax/pull/1039>Fix 914</a></li><li>#1037: <a href=https://github.com/hacspec/hax/pull/1037>Machine int constructors and conversions</a></li><li>#1036: <a href=https://github.com/hacspec/hax/pull/1036>Upgrade rustc</a></li><li>#1035: <a href=https://github.com/hacspec/hax/pull/1035>feat: check licenses</a></li><li>#1031: <a href=https://github.com/hacspec/hax/pull/1031>Improve trait resolution</a></li><li>#1030: <a href=https://github.com/hacspec/hax/pull/1030>Avoid bundling use items.</a></li><li>#1029: <a href=https://github.com/hacspec/hax/pull/1029>feat: deduplicate types in haxmeta and JSON</a></li><li>#1027: <a href=https://github.com/hacspec/hax/pull/1027>fix(frontend): this was reverted by mistake</a></li><li>#1024: <a href=https://github.com/hacspec/hax/pull/1024>Reorganize <code>frontend/exporter/types</code></a></li><li>#1023: <a href=https://github.com/hacspec/hax/pull/1023>PV backend example: Simple PSK based protocol</a></li><li>#1022: <a href=https://github.com/hacspec/hax/pull/1022>some fixes for iterators.f_next and update_at_usize</a></li><li>#1020: <a href=https://github.com/hacspec/hax/pull/1020>Quote items track replace</a></li><li>#1018: <a href=https://github.com/hacspec/hax/pull/1018>fix(engine/import_thir): never drop bodies of constants</a></li><li>#1015: <a href=https://github.com/hacspec/hax/pull/1015>fix(frontend): issue #1014</a></li><li>#1012: <a href=https://github.com/hacspec/hax/pull/1012>fix: justfile</a></li><li>#1011: <a href=https://github.com/hacspec/hax/pull/1011>fix(engine): also rename concrete idents within a projector.</a></li><li>#1008: <a href=https://github.com/hacspec/hax/pull/1008>Support <code>impl Trait</code> in trait resolution</a></li><li>#1007: <a href=https://github.com/hacspec/hax/pull/1007>feat(cli): better version information</a></li><li>#1006: <a href=https://github.com/hacspec/hax/pull/1006>Support more features</a></li><li>#1002: <a href=https://github.com/hacspec/hax/pull/1002>Fix bug with recursive bundles depending on items from original modules.</a></li><li>#1000: <a href=https://github.com/hacspec/hax/pull/1000>Cache <code>FullDef</code> translation and add more information to it</a></li><li>#999: <a href=https://github.com/hacspec/hax/pull/999>Exporter get variant information works on unions</a></li><li>#996: <a href=https://github.com/hacspec/hax/pull/996>Cache many things</a></li><li>#994: <a href=https://github.com/hacspec/hax/pull/994>fix: DEV.md debug engine</a></li><li>#990: <a href=https://github.com/hacspec/hax/pull/990>Remove workaround in trait resolution for associated items</a></li><li>#989: <a href=https://github.com/hacspec/hax/pull/989>fix(engine): make consts fun. calls of arity 0 when there is an impl expr</a></li><li>#988: <a href=https://github.com/hacspec/hax/pull/988>feat(engine) Rewrite control flow inside loops.</a></li><li>#987: <a href=https://github.com/hacspec/hax/pull/987>Coq generic printer</a></li><li>#984: <a href=https://github.com/hacspec/hax/pull/984>feat: just use <code>just</code></a></li><li>#981: <a href=https://github.com/hacspec/hax/pull/981>Make options extensible</a></li><li>#977: <a href=https://github.com/hacspec/hax/pull/977>More improvements to trait resolution</a></li><li>#970: <a href=https://github.com/hacspec/hax/pull/970>Rework trait resolution to support GATs</a></li><li>#969: <a href=https://github.com/hacspec/hax/pull/969>Release <code>0.1.0-alpha.1</code></a></li><li>#964: <a href=https://github.com/hacspec/hax/pull/964>feat(contributing): add a <code>regressions</code> section</a></li><li>#961: <a href=https://github.com/hacspec/hax/pull/961>Update README.md</a></li><li>#960: <a href=https://github.com/hacspec/hax/pull/960>feat(engine): add <code>ast_destruct</code> module</a></li><li>#959: <a href=https://github.com/hacspec/hax/pull/959>Prefer <code>try_normalize_erasing_regions</code></a></li><li>#958: <a href=https://github.com/hacspec/hax/pull/958>feat(engine): add module <code>ast_builder</code></a></li><li>#957: <a href=https://github.com/hacspec/hax/pull/957>Ignore structs in variants renaming for bundling.</a></li><li>#956: <a href=https://github.com/hacspec/hax/pull/956>Run <code>cargo clippy --fix</code></a></li><li>#955: <a href=https://github.com/hacspec/hax/pull/955>feat(frontend): collect regular comments</a></li><li>#952: <a href=https://github.com/hacspec/hax/pull/952>feat(doc): add <code>CONTRIBUTING.md</code></a></li><li>#950: <a href=https://github.com/hacspec/hax/pull/950>feat(nix/utils): intro. <code>check-unimlemented-issue-coherency</code></a></li><li>#949: <a href=https://github.com/hacspec/hax/pull/949>fix(engine): change issue id</a></li><li>#948: <a href=https://github.com/hacspec/hax/pull/948>fix(engine/f*): convert an unimplemented to an assertion failure</a></li><li>#947: <a href=https://github.com/hacspec/hax/pull/947>fix(exporter+engine): drop default parameters on traits</a></li><li>#945: <a href=https://github.com/hacspec/hax/pull/945>feat(engine/f*): allow unsafe code</a></li><li>#935: <a href=https://github.com/hacspec/hax/pull/935>Handle cyclic module dependencies</a></li><li>#851: <a href=https://github.com/hacspec/hax/pull/851>fix(engine): expose type of local_ident.id</a></li><li>#533: <a href=https://github.com/hacspec/hax/pull/533>more principled generic printer</a></li></ul><h3 id=contributors>Contributors<a hidden class=anchor aria-hidden=true href=#contributors>#</a></h3><ul><li><a href=https://github.com/cmester0>@cmester0</a></li><li><a href=https://github.com/W95Psp>@W95Psp</a></li><li><a href=https://github.com/jschneider-bensch>@jschneider-bensch</a></li><li><a href=https://github.com/spitters>@spitters</a></li><li><a href=https://github.com/franziskuskiefer>@franziskuskiefer</a></li><li><a href=https://github.com/Nadrieril>@Nadrieril</a></li><li><a href=https://github.com/karthikbhargavan>@karthikbhargavan</a></li><li><a href=https://github.com/maximebuyse>@maximebuyse</a></li><li><a href=https://github.com/paulmure>@paulmure</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://hacspec.github.io/blog/tags/this-month-in-hax/>this-month-in-hax</a></li></ul><nav class=paginav><a class=next href=https://hacspec.github.io/blog/posts/this-month-in-hax/2024-09/><span class=title>Next Â»</span><br><span>This month in hax: September 2024</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://hacspec.github.io/blog/>hax</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>